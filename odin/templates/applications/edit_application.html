{% extends "dashboard/dashboard_base.html" %}
{% load widget_tweaks education_extras utils %}

{% block title %}
  Edit Applciation
{% endblock title %}

{% block content_title %}
    <h1><center>Edit application for course</center></h1>
{% endblock content_title %}

{% block page_content %}
  <style>
    textarea {
      min-height: 300px;
      border: 1px solid black !important;
      padding-left: 10px !important;
    }
  </style>
 <div class="row margin-bottom-40 stories-header" data-auto-height="true">
    <div class="col-md-12">
        <h2>{{ course.name }}</h2>
    </div>
 </div>
 <div class="row">
  <div class="col-md-12">
    {% include "education/partial/message_box.html" %}
    {% include "partial/form_errors.html" with errors=readable_errors %}
    <div class="portlet light">
      <div class="portlet-title">
        <div class="caption font-blue-sunglo">
          <i class="icon-settings font-blue-sunglo"></i>
          <span class="caption-subject bold uppercase">Edit Application</span>
        </div>
      </div>
      <div class="portlet-body form">
        <form action="" method="POST">
          <div class="form-body">
            {% csrf_token %}

            <div class="form-group form-md-line-input">
              {% render_field form.phone class="form-control form-control-solid placeholder-no-fix" id="form_control_1" placeholder="Phone number" %}
            </div>
            <div class="form-group form-md-line-input">
              {% render_field form.skype class="form-control form-control-solid placeholder-no-fix" id="form_control_1" placeholder="Skype" %}
	    </div>
            <div class="form-group form-md-line-input">
              {% render_field form.works_at class="form-control form-control-solid placeholder-no-fix" id="form_control_1" placeholder="Where do you work?" %}
	    </div>
            <div class="form-group form-md-line-input">
              {% render_field form.studies_at class="form-control form-control-solid placeholder-no-fix" id="form_control_1" placeholder="Where do you study?" %}
	    </div>
            <div class="form-actions noborder">
              <button class="btn green uppercase" type="submit">Update application</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  {% if application.application_info.has_competition %}

  <div class="row-md-12">
    <div class="portlet light">
      <div class="portlet-title">
        <div class="caption font-blue-sunglo">
          <i class="icon-settings font-blue-sunglo"></i>
          <span class="caption-subject bold uppercase">Application tasks</span>
        </div>
      </div>
      <div class="portlet-body">
        <p>In order to complete your application, please provide solutions to all tasks below</p>
        <div class="form">
          <form action="{% url 'dashboard:competitions:update-application-competition-solutions' %}" method="POST">
            <div class="form-body">
              {% csrf_token %}
              <input type="hidden" name="application" value="{{ application.id }}" />
              {% for competition_task in application.application_info.competition.tasks.all %} 
                <h2>{{ competition_task.task.name }}</h2>
                {% autoescape off %}
                  <p>{{ competition_task.task.description|markdown }}</p>
                {% endautoescape %}
                <div class="form-group form-md-line-input">
                    {% if last_solutions|has_key:competition_task.id %}
                      {% with last_solutions|get_key:competition_task.id as solution %}
                      <textarea class="form-control form-control-solid placeholder-no-fix" placeholder="Paste your solution (code) here." name="task_{{ competition_task.id}}">{{ solution.code }}</textarea>
                      {% endwith %}
                      {% else %}
                  <textarea class="form-control form-control-solid placeholder-no-fix" placeholder="Paste your task solution (code) here." name="task_{{ competition_task.id}}"></textarea>
                    {% endif %}
                </div>
              {% endfor %}
            </div>
            <div class="form-actions noborder">
              <button class="btn green uppercase" type="submit">Update solutions</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  {% endif %}

</div
{% endblock page_content %}
